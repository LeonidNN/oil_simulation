# Oil Reservoir Optimization with Neural Network Surrogate

Проект демонстрирует оптимизацию режимов работы нефтяного пласта с использованием численного симулятора и нейросетевого суррогата.

## Принцип работы
1. C++ часть выполняет тяжёлые вычисления: симуляцию пласта. Эта часть была взята с `https://github.com/OPM/opm-simulators`. Симулятор принимает на вход массив oper_con = [q1, q2, q3, q4, inj], где q1–q4 — дебиты четырёх добывающих скважин (500–6000), а inj — интенсивность закачки для поддержания давления (2000–15000). На их основе расчитывается величина S — экономическая эффективность работы скважин.
2. Python + PyTorch обучает нейросеть (MLP 5–64–64–1), которая учится подбирать параметры, максимизирующие экономическую эффективность.
3. Градиентный подъём по входам нейросети улучшает управляющие параметры.
4. Результат нейросети оказался в среднем на 16% эффективнее с экономической точки зрения, чем результат, получавшийся из параметров, изначально заданных человеком.

## Архитектура
- **C++ (pybind11)**: симулятор, Halton sampling, поиск подъёмов, локальная генерация.
- **Python (PyTorch)**: обучение MLP и оптимизация входных параметров.
- **Интерфейс**: C++ экспортируется как Python-модуль `reservoir_core`.

## Структура проекта
```
project/
  cpp/
    reservoir_core.cpp
  CMakeLists.txt
  pyproject.toml
  main.py
  README.md
```

## Зависимости
- Python 3.10+
- PyTorch
- NumPy
- pybind11
- scikit-build-core
- Visual C++ Build Tools (MSVC, Windows SDK)

## Сборка C++ модуля
Из корня проекта:
```bash
pip install -v -e .
```

Проверка:
```bat
where cl
```

## Запуск
```bash
python main.py
```

## Результат
Скрипт сравнивает базовый «человеческий» режим и оптимизированный режим, найденный нейросетью, по целевой метрике S.

## Примечание
Проект ориентирован на демонстрацию подхода «симулятор + ML-суррогат» и не претендует на физически точную модель пласта.
